{% extends 'base.twig' %}

{% block body %}
	{% if not basket %}
		{% include 'filter_table.twig' with {'values': values, 'metas':metas}%}
	{% else %}
		<a href='download_basket.php' target='_blank'>Download Basket</a><br/>&nbsp;<br/>
	{% endif %}

	<table class="table table-responsive table-hover table-striped rounded-lg shadow text-center">
		<thead>
		<tr>
			<th> </th>
			{% for data in metas["record"] %}
				<th> {{ data["label"] }}</th>
			{% endfor %}
			<th> </th>
			{% for data in metas["production"] %}
				<th> {{ data["label"] }}</th>
			{% endfor %}
			{% for data in metas["speaker"] %}
				<th> {{ data["label"] }}</th>
			{% endfor %}
			<th> </th>
		</tr>
		</thead>
		<tbody>
		{% for data in results %}
			<tr id="record{{ data["record_id"] }}">
				{% include 'one_record.twig' with {'data': data, 'metas':metas} %}
			</tr>
		{% endfor %}
		</tbody>
	</table>

{% endblock %}

{% block script %}
	<script type="text/javascript">
		$("#edit_form").validate();
		function add_to_basket(rid){
			$.ajax
			({
				url: 'add_to_basket.php',
				data: "rid="+rid+"&act=add",
				type: 'post',
				success: function(result)
				{
					$('#b_'+rid+'_add').hide();
					$('#b_'+rid+'_rem').show();
				}
			});
		}
		function rem_from_basket(rid){
			$.ajax
			({
				url: 'add_to_basket.php',
				data: "rid="+rid+"&act=rem",
				type: 'post',
				success: function(result)
				{
					$('#b_'+rid+'_rem').hide();
					$('#b_'+rid+'_add').show();
				}
			});
		}
		function clear_elt(element_id){
			$('#'+element_id).val('');
		}
		$( function() {
			$( ".dp" ).datepicker({
				dateFormat: "dd/mm/yy",
			});
		} );
	</script>
	{% if not basket %}
		<script type="text/javascript">
			$("#edit_form").validate();
		</script>
	{% endif %}
{% endblock %}
